{% load static %}
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>DL Size Leaflet</title>
  <link rel="stylesheet" href="{% static 'css/leaflet.css' %}">
  {# All print/PDF styles live in static/css/leaflet.css now #}
  </head>
<body>
  <!-- Controls outside the printable leaflet -->
  {% if not pdf %}
  <div class="leaflet-toolbar">
    {% if leaflet_saved %}
    <div class="leaflet-alert">Default leaflet text saved.</div>
    {% endif %}
    <a href="{% url 'home' %}" class="back-home" aria-label="Back to home">Back home</a>
    <form class="lf-url-form" method="get" action="{% url '_product_management:dl' %}" aria-label="Customize leaflet sections">
      {% csrf_token %}
      <div class="lf-field-stack">
        <label for="site" class="visually-hidden">Website URL for QR code</label>
        <input id="site" name="site" type="url" placeholder="https://example.com" value="{{ request.GET.site }}">
      </div>
      <details class="lf-editor"{% if request.GET.company_name or request.GET.company_tagline or request.GET.headline or request.GET.bullet_1 or request.GET.bullet_2 or request.GET.bullet_3 or request.GET.cta_title or request.GET.cta_subtitle %} open{% endif %}>
        <summary>Edit leaflet copy</summary>
        <div class="lf-editor-grid">
          <div>
            <label for="company_name">Company name</label>
            <input id="company_name" name="company_name" type="text" value="{{ company_name }}">
          </div>
          <div>
            <label for="company_tagline">Company tagline</label>
            <input id="company_tagline" name="company_tagline" type="text" value="{{ company_tagline }}">
          </div>
          <div>
            <label for="headline">Headline</label>
            <input id="headline" name="headline" type="text" value="{{ headline }}">
          </div>
          <div>
            <label for="bullet_1">Bullet 1</label>
            <input id="bullet_1" name="bullet_1" type="text" value="{{ bullet_1 }}">
          </div>
          <div>
            <label for="bullet_2">Bullet 2</label>
            <input id="bullet_2" name="bullet_2" type="text" value="{{ bullet_2 }}">
          </div>
          <div>
            <label for="bullet_3">Bullet 3</label>
            <input id="bullet_3" name="bullet_3" type="text" value="{{ bullet_3 }}">
          </div>
          <div>
            <label for="cta_title">CTA title</label>
            <input id="cta_title" name="cta_title" type="text" value="{{ cta_title }}">
          </div>
          <div>
            <label for="cta_subtitle">CTA description</label>
            <textarea id="cta_subtitle" name="cta_subtitle" rows="2">{{ cta_subtitle }}</textarea>
          </div>
        </div>
      </details>
      <div class="lf-toolbar-actions">
        <button type="submit" class="btn-primary">Update preview</button>
        {% if can_save_leaflet %}
        <button type="submit" class="btn-secondary" formmethod="post" formaction="{% url '_product_management:dl_save_copy' %}">Save as default</button>
        {% endif %}
      </div>
    </form>
    {% if normalized_site %}
      {% if site_query_string %}
        <a class="back-home" href="{% url '_product_management:dl_pdf' %}?{{ site_query_string }}" aria-label="Download PDF">Download PDF</a>
      {% else %}
        <a class="back-home" href="{% url '_product_management:dl_pdf' %}?site={{ normalized_site|urlencode }}" aria-label="Download PDF">Download PDF</a>
      {% endif %}
    {% else %}
      <span class="back-home disabled" aria-disabled="true">Download PDF</span>
    {% endif %}
  </div>
  {% endif %}

  <div class="leaflet">
    <main class="lf-body">
      <div class="lf-table">
        <!-- Top stack: auto height content -->
        <div class="row stack"><div class="stack-inner">
          
        <!-- 1) Company banner: logo + company name -->
        <section class="seg seg-banner">
            <div class="banner-logo"><img src="{% static 'images/Kingston_Online_Grocery_logo.png' %}" alt="Kingston Online Grocery logo"></div>
            <div class="banner-text">
              <p class="company-name">{{ company_name }}</p>
              <p class="company-tag">{{ company_tagline }}</p>
            </div>
          </section>

        
          <!-- Hero image section -->
        
          <section class="seg seg-hero">
          <img class="hero-img" src="{% static 'images/fresh_products.jpg' %}" alt="Fresh products">
        </section>

        <!-- 2) Marketing slogans / deals -->
        <section class="seg seg-slogans">
          <p class="headline">{{ headline }}</p>
          <ul class="bullets">
            <li>{{ bullet_1 }}</li>
            <li>{{ bullet_2 }}</li>
            <li>{{ bullet_3 }}</li>
          </ul>
        </section>

        <!-- 3) Call to action for QR scan -->
        <section class="seg seg-cta">
          <p class="cta-title">{{ cta_title }}</p>
          <p class="cta-sub">{{ cta_subtitle }}</p>
        </section>

        </div></div>

        <!-- Bottom row: expands to remaining height; QR anchored to bottom -->
        <div class="row qr-row"><div class="qr-row-cell">
          <section class="seg seg-qr">
              <div class="qr-wrap" aria-live="polite">
                {% if pdf and qr_data_uri %}
                  <img class="qr" src="{{ qr_data_uri }}" alt="QR code linking to {{ normalized_site|default:request.GET.site }}">
                {% elif request.GET.site %}
                  <img class="qr" src="{% url '_product_management:qr' %}?site={{ request.GET.site|urlencode }}{% if qr_kind %}&kind={{ qr_kind }}{% endif %}" alt="QR code linking to {{ normalized_site|default:request.GET.site }}" loading="lazy">
                {% else %}
                  <span class="muted">Add a website URL above to render QR</span>
                {% endif %}
              </div>
              {% if normalized_site %}
              <div class="qr-url muted">{{ normalized_site }}</div>
              {% elif request.GET.site %}
              <div class="qr-url muted">{{ request.GET.site }}</div>
              {% endif %}
            </section>
        </div></div>
      </div>
    </main>
  </div>
</body>
</html>
