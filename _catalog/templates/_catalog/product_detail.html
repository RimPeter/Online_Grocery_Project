{% extends "base.html" %}
{% load static %}

{% block title %}{{ product.name }}{% endblock %}

{% block content %}
<div id="main" class="main productpagenav">
    <div class="inner">
        <!-- Breadcrumb navigation -->
        <div class="prodnav mobile">
            <ul class="breadcrumb">
                {% if product.sub_category %}
                    <li><a href="{% url 'product_list' %}?l1={{ product.sub_category|urlencode }}">{{ product.sub_category }}</a></li>
                {% endif %}
                {% if product.sub_subcategory %}
                    <li><a href="{% url 'product_list' %}?l1={{ product.sub_category|urlencode }}&l2={{ product.sub_subcategory|urlencode }}">{{ product.sub_subcategory }}</a></li>
                {% endif %}
                <li>{{ product.name }}</li>
            </ul>
        </div>

        <!-- Product details -->
        <div class="shop-products productpagedetail" id="shop-products">
            <div class="productpagedetail-inner">
                <!-- Product Image -->
                <div class="prodimage">
                    <span class="prodimage-main">
                        <img src="{% if product.image_url %}{{ product.image_url }}{% else %}{% static 'images/fresh_products.jpg' %}{% endif %}" alt="{{ product.name }}" id="prodimage" loading="lazy">
                    </span>
                </div>

                <!-- Product Information -->
                <div class="right">
                    <h1 class="prodname">{{ product.name }}</h1>
                    <p class="prodsize">&pound;{{ product.price|floatformat:2 }}{% if product.list_position %} - {{ product.list_position }}{% endif %}</p>
                    <form method="POST" action="{% url 'add_to_cart' product.id %}">
                        {% csrf_token %}
                        <input type="hidden" name="return_to" value="{{ request.get_full_path }}">
                        <div class="input-group mb-2">
                            <input
                                type="number"
                                name="quantity"
                                class="form-control"
                                value="1"
                                min="1"
                                step="1"
                                aria-label="Quantity"
                            />
                            <button type="submit" class="btn btn-primary">Add</button>
                        </div>
                    </form>
                    <div class="blueline">&nbsp;</div>
                    {% if not user.is_authenticated %}
                    <p class="prodlogin"><a href="{% url 'login' %}">Log in to buy</a></p>
                    {% endif %}
                    <div class="blueline">&nbsp;</div>
                    <table class="prodtable">
                        <tbody>
                            <tr><th>Product:</th><td>{{ product.name }}</td></tr>
                            <tr><th>RSP:</th><td>{% if product.rsp %}&pound;{{ product.rsp|floatformat:2 }}{% else %}N/A{% endif %}</td></tr>
                            <tr><th>Promotion Ends:</th>
                                <td>
                                    {% if product.promotion_end_date %}{{ product.promotion_end_date|date:"d M Y" }}{% else %}N/A{% endif %}
                                </td>
                            </tr>
                            <tr><th>VAT Rate:</th><td>{{ product.get_vat_rate_display }}</td></tr>
                            <tr><th>Retail EAN:</th><td>{{ product.retail_EAN|default:"N/A" }}</td></tr>
                            <tr><th>Main Category:</th><td>{{ product.main_category|default:"N/A" }}</td></tr>
                            <tr><th>Sub Category:</th><td>{{ product.sub_category|default:"N/A" }}</td></tr>
                            <tr><th>Sub-subcategory:</th><td>{{ product.sub_subcategory|default:"N/A" }}</td></tr>
                            <tr><th>Variant:</th><td>{{ product.variant|default:"N/A" }}</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Disclaimer -->
        <p class="disclaimer">
            The image and product information have been prepared for illustration and information purposes only and may differ from that shown.
        </p>
    </div>
</div>
{% endblock %}
